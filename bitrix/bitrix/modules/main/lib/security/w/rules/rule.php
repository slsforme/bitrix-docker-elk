<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____619167736']= array(base64_decode('a'.'XNfc3RyaW5'.'n'),base64_decode(''.'c3'.'Ry'.'dG'.'9sb3dlcg='.'='),base64_decode('aXN'.'fYXJyYXk='),base64_decode('aXNfc3Rya'.'W5'.'n'),base64_decode('Z3pkZ'.'WN'.'vZGU='),base64_decode('YmFzZTY0X'.'2RlY2'.'9kZQ=='),base64_decode('dX'.'JsZGVjb2Rl'),base64_decode('YXJy'.'Y'.'Xlf'.'cmV2ZXJ'.'zZQ=='),base64_decode(''.'Z3'.'p'.'lb'.'m'.'Nv'.'ZG'.'U='),base64_decode('YmFz'.'Z'.'TY0X2'.'VuY29kZ'.'Q=='),base64_decode('dXJsZW'.'5j'.'b2'.'Rl'),base64_decode(''.'Ym'.'luMmhl'.'eA=='),base64_decode('a'.'XNfYXJyYXk='),base64_decode('c3'.'Ryd'.'G9'.'sb'.'3d'.'lcg=='),base64_decode('aXNfY'.'X'.'J'.'yYXk='),base64_decode(''.'am'.'9'.'pbg=='),base64_decode(''.'Z'.'m5tY'.'X'.'RjaA'.'=='),base64_decode('cmF3dXJs'.'ZG'.'Vjb2Rl'),base64_decode('c3Vic3Ry'),base64_decode(''.'c3Vic3Ry'),base64_decode(''.'c'.'3R'.'yX3'.'J'.'lcGxhY2U='),base64_decode(''.'c'.'H'.'JlZ19x'.'dW90Z'.'Q='.'='),base64_decode('c'.'H'.'J'.'l'.'Z'.'19tYXR'.'jaA=='));if(!function_exists(__NAMESPACE__.'\\___693484036')){function ___693484036($_1899375129){static $_1470368074= false; if($_1470368074 == false) $_1470368074=array('YW'.'N'.'0aW'.'9u','aW50'.'d'.'mFs','c'.'GF0'.'aA==','Y'.'29udGV4dA==','a'.'2V5cw==','cH'.'JvY2Vzcw==','Z'.'W5'.'j'.'b2Rpbm'.'c=',''.'cHJ'.'lZ'.'19yZ'.'XBsY'.'WNl','cG'.'F'.'0'.'a'.'A==','Y29udGV4'.'d'.'A==','a'.'2V5'.'c'.'w==','cHJvY2'.'Vzc'.'w==',''.'Z'.'W5jb2Rpbmc'.'=','cGF0dGVybg==',''.'cHJlZ19tYXRjaA==',''.'cGF0aA='.'=','Y'.'29u'.'dGV'.'4dA==','a2V5cw==',''.'cHJvY2Vzcw'.'==',''.'ZW'.'5'.'jb2Rpb'.'m'.'c=','cG'.'F'.'0d'.'GVybg'.'==','cG9zd'.'F9hY'.'3'.'Rpb'.'24=',''.'Y'.'2hlY2tfY'.'3NyZg'.'==',''.'cGF0aA='.'=','Y'.'29udGV4d'.'A==','a2V5'.'cw==','c'.'HJvY'.'2'.'V'.'zcw='.'=',''.'ZW5jb2R'.'pbmc'.'=','cGF0dGVy'.'b'.'g==','YWN0'.'aW'.'9'.'u','YWN0'.'aW9u','Y'.'WN0aW9u','Y'.'WN0aW9u','YWN0a'.'W9'.'u','YWN'.'0a'.'W'.'9u','cG9zdF9h'.'Y3Rpb2'.'4'.'=','ZW5j'.'b'.'2Rpbmc=','ZW5'.'jb2'.'Rpbmc=','ZW5j'.'b2'.'Rp'.'bmc=','Z'.'W'.'5jb2Rpbmc=','ZW'.'5'.'jb'.'2Rpbmc=','Z'.'W5'.'j'.'b2Rp'.'bmc=','Z3o=',''.'Ym'.'FzZ'.'TY0',''.'dX'.'Js','aGV4',''.'Lg==','Lw='.'=','a'.'W5kZXgucGh'.'w','L2l'.'uZGV4'.'LnBocA==','U0NSSVB'.'U'.'X'.'05'.'BT'.'UU'.'=','L2luZGV4Ln'.'BocA='.'=','U0'.'NSSVB'.'UX05BTUU'.'=','U0NSSVBU'.'X0'.'5BTUU=','U0NSSVBUX05BTUU=','fg==','f'.'l4=','fg'.'='.'=','XH4=','J'.'H4=');return base64_decode($_1470368074[$_1899375129]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_1504660636; protected $_872417503; protected $_2109176342; protected $_190116138; protected $_1846184374; public static function make(array $_1833305784):?static{ $_1833305784= static::prepareRuleParameters($_1833305784); return match($_1833305784[___693484036(0)]){ ___693484036(1) => new IntvalRule( $_1833305784[___693484036(2)], $_1833305784[___693484036(3)], $_1833305784[___693484036(4)], $_1833305784[___693484036(5)], $_1833305784[___693484036(6)]), ___693484036(7) => new PregReplaceRule( $_1833305784[___693484036(8)], $_1833305784[___693484036(9)], $_1833305784[___693484036(10)], $_1833305784[___693484036(11)], $_1833305784[___693484036(12)], $_1833305784[___693484036(13)]), ___693484036(14) => new PregMatchRule( $_1833305784[___693484036(15)], $_1833305784[___693484036(16)], $_1833305784[___693484036(17)], $_1833305784[___693484036(18)], $_1833305784[___693484036(19)], $_1833305784[___693484036(20)], $_1833305784[___693484036(21)]), ___693484036(22) => new CsrfRule( $_1833305784[___693484036(23)], $_1833305784[___693484036(24)], $_1833305784[___693484036(25)], $_1833305784[___693484036(26)], $_1833305784[___693484036(27)], $_1833305784[___693484036(28)],), default => null,};} protected static function prepareRuleParameters(array $_49046993): array{ if($GLOBALS['____619167736'][0]($_49046993[___693484036(29)])){ $_49046993[___693484036(30)]= $GLOBALS['____619167736'][1]($_49046993[___693484036(31)]);} elseif($GLOBALS['____619167736'][2]($_49046993[___693484036(32)])){ $_1884435650= $_49046993[___693484036(33)]; $_49046993[___693484036(34)]= $_1884435650[min(42,0,14)]; $_49046993[___693484036(35)]= $_1884435650[round(0+1)];} $_49046993[___693484036(36)]=!empty($_49046993[___693484036(37)])? $_49046993[___693484036(38)]:[]; if($GLOBALS['____619167736'][3]($_49046993[___693484036(39)])){ $_49046993[___693484036(40)]=[$_49046993[___693484036(41)]];} return $_49046993;}  public function __construct($_1504660636, $_872417503, $_2109176342, $_190116138, $_1846184374){ $this->_1504660636= $_1504660636; $this->_872417503= $this->castContext($_872417503); $this->_2109176342= $this->castKeys($_2109176342); $this->_190116138= $_190116138; $this->_1846184374= $_1846184374;} public function evaluateValue($_792492043){ if(!empty($this->_1846184374)){ foreach($this->_1846184374 as $_178046821){ $_792492043= match($_178046821){ 'gz' => $GLOBALS['____619167736'][4]($_792492043), 'base64' => $GLOBALS['____619167736'][5]($_792492043), 'url' => $GLOBALS['____619167736'][6]($_792492043), 'hex' => hex2bin($_792492043)};}} $_302729897= $this->evaluate($_792492043); if(!empty($this->_1846184374) && $_302729897 instanceof ModifyResult){ $_760225594= $_302729897->getCleanValue(); foreach($GLOBALS['____619167736'][7]($this->_1846184374) as $_178046821){ $_760225594= match($_178046821){ ___693484036(42) => $GLOBALS['____619167736'][8]($_760225594), ___693484036(43) => $GLOBALS['____619167736'][9]($_760225594), ___693484036(44) => $GLOBALS['____619167736'][10]($_760225594), ___693484036(45) => $GLOBALS['____619167736'][11]($_760225594)};} $_302729897= new ModifyResult($_760225594);} return $_302729897;} abstract public function evaluate($_792492043); protected function castContext($_872417503){ if(!$GLOBALS['____619167736'][12]($_872417503)){ $_872417503=[$_872417503];} foreach($_872417503 as $_146305816 => $_1367207427){ $_872417503[$_146305816]= $GLOBALS['____619167736'][13]($_1367207427);} return $_872417503;} protected function castKeys($_2109176342){ if(!$GLOBALS['____619167736'][14]($_2109176342)){ $_2109176342=[$_2109176342];} return $_2109176342;} public function matchKey(array $_1721413933): bool{ $_1721413933= $GLOBALS['____619167736'][15](___693484036(46), $_1721413933); foreach($this->_2109176342 as $_635095186){   if($GLOBALS['____619167736'][16]($_635095186, $_1721413933)){ return true;}} return false;}  public function matchPath($_244187420){ if($this->_1504660636 === '*'){ return true;}  $_223821725= new Uri($_244187420); $_1364241889= $_223821725->getPath(); $_1364241889= $GLOBALS['____619167736'][17]($_1364241889);      if(str_ends_with($_1364241889, ___693484036(47))){ $_1364241889 .= ___693484036(48);} $_1364241889= Path::normalize($_1364241889);  $_445647556[]= $_1364241889; if(str_ends_with($_1364241889, ___693484036(49))){ $_445647556[]= $GLOBALS['____619167736'][18]($_1364241889,(854-2*427),-round(0+2.25+2.25+2.25+2.25));} elseif(str_ends_with($_SERVER[___693484036(50)], ___693484036(51))){ $_445647556[]= $GLOBALS['____619167736'][19]($_SERVER[___693484036(52)], min(50,0,16.666666666667),-round(0+2.25+2.25+2.25+2.25));} if($_1364241889 !== $_SERVER[___693484036(53)]){ $_445647556[]= $_SERVER[___693484036(54)];}  if(str_starts_with($this->_1504660636, ___693484036(55))){ $_1113187043= $this->_1504660636;} else{ $_1113187043= ___693484036(56). $GLOBALS['____619167736'][20](___693484036(57), ___693484036(58), $GLOBALS['____619167736'][21]($this->_1504660636)). ___693484036(59);} foreach($_445647556 as $_999150762){ if($this->_1504660636 === $_999150762 || $GLOBALS['____619167736'][22]($_1113187043, $_999150762)){ return true;}} return false;}  public function getPath(){ return $this->_1504660636;}  public function getContext(){ return $this->_872417503;}  public function getKeys(){ return $this->_2109176342;}  public function getProcess(){ return $this->_190116138;}}?>